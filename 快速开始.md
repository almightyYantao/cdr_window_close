# 快速开始指南

## 🎯 项目概述

这是一个CorelDRAW插件,自动处理打开CDR文件时的错误提示(如"无效的轮廓ID"),自动点击"忽略"按钮。

---

## 📱 给用户的快速说明

### 用户安装步骤(超简单!)

1. 解压收到的 `CorelDRAW-AutoIgnoreError-Plugin.zip`
2. 右键点击 `install.bat` → 选择 **"以管理员身份运行"**
3. 重启CorelDRAW
4. 完成!

详细说明请看压缩包内的 `使用说明.txt`

---

## 🛠️ 给开发者的操作指南(Mac环境)

### 方案1: 使用GitHub Actions自动编译(推荐)

#### 第一次发布:

```bash
# 1. 克隆或进入项目目录
cd /Users/yantao/Documents/yantao/yantao_code/cdr_window_close

# 2. 重要! 修改GUID
# 生成新的GUID
uuidgen
# 然后在 CorelDrawPlugin.cs 第11行替换GUID

# 3. 创建GitHub仓库并关联
git init
git add .
git commit -m "Initial commit"
git remote add origin https://github.com/YOUR_USERNAME/cdr-auto-ignore-error.git
git push -u origin main

# 4. 发布第一个版本
./release.sh
# 输入版本号: 1.0.0
```

#### 后续发布:

```bash
# 修改代码后,运行
./release.sh
# 输入新版本号,例如: 1.0.1
```

#### 获取编译好的插件:

1. 等待3-5分钟,GitHub Actions自动编译
2. 访问: `https://github.com/YOUR_USERNAME/YOUR_REPO/releases`
3. 下载 `CorelDRAW-AutoIgnoreError-Plugin.zip`
4. 将这个ZIP文件发给用户

### 方案2: 在Windows上本地编译

如果你有Windows电脑或虚拟机:

```batch
# 在Windows上运行
build.bat
```

会生成 `CorelDRAW-AutoIgnoreError-Plugin.zip`,直接发给用户。

---

## 📁 项目结构

```
cdr_window_close/
├── CorelDrawPlugin.cs              # 插件主类
├── ErrorDialogMonitor.cs           # 错误对话框监控器
├── CorelDrawAutoIgnoreError.csproj # 项目配置
│
├── installer/                      # 用户安装包文件
│   ├── install.bat                 # 用户安装脚本(双击运行)
│   ├── uninstall.bat              # 卸载脚本
│   └── 使用说明.txt                # 用户说明文档
│
├── .github/workflows/              # GitHub Actions配置
│   └── build-release.yml           # 自动编译工作流
│
├── release.sh                      # 快速发布脚本(Mac)
├── build.bat                       # 编译脚本(Windows)
│
└── 文档/
    ├── README.md                   # 项目说明
    ├── DEPLOY.md                   # 详细发布指南
    └── INSTALL.md                  # 详细安装指南
```

---

## 🔑 重要配置

### 首次使用前必须修改GUID!

在Mac上生成新GUID:
```bash
uuidgen
```

在 [CorelDrawPlugin.cs](CorelDrawPlugin.cs#L11) 中替换:
```csharp
[Guid("YOUR-NEW-GUID-HERE")]
```

---

## 💡 常见场景

### 场景1: 我要给用户一个安装包(Mac环境)

```bash
# 1. 修改GUID(首次)
# 2. 推送到GitHub
git push

# 3. 发布版本
./release.sh

# 4. 等待编译完成
# 5. 在GitHub Releases下载ZIP
# 6. 发给用户
```

### 场景2: 我要更新插件

```bash
# 修改代码...

# 提交并发布新版本
./release.sh
# 输入新版本号,例如: 1.0.2
```

### 场景3: 用户反馈安装失败

检查清单:
1. 是否以管理员权限运行 install.bat?
2. 是否安装了 .NET Framework 4.7.2?
3. 查看 `installer/使用说明.txt` 的常见问题部分

---

## 🚀 快速命令参考

### Mac上:

```bash
# 生成GUID
uuidgen

# 快速发布
./release.sh

# 查看项目结构
tree -L 2
```

### Windows上:

```batch
# 编译打包
build.bat

# 测试安装(以管理员运行)
installer\install.bat

# 卸载(以管理员运行)
installer\uninstall.bat
```

---

## 📞 获取帮助

- 用户安装问题: 查看 `installer/使用说明.txt`
- 开发者问题: 查看 `DEPLOY.md`
- 技术细节: 查看 `INSTALL.md`

---

## ✅ 检查清单

### 发布前:
- [ ] 已修改GUID为唯一值
- [ ] 已在Windows上测试过(如可能)
- [ ] 版本号已更新
- [ ] 提交了所有代码

### 给用户前:
- [ ] ZIP包包含所有必需文件
- [ ] 测试过install.bat能正常运行
- [ ] 提供了使用说明

---

**提示**: 大多数情况下,你只需要运行 `./release.sh`,等GitHub编译完成,下载ZIP发给用户即可!
